AArch64 LB+gcsss2-dmb.sy+dmb.ld-gcsss1
variant=shadowstack
{
SS(x,2);
SS(z,1) = ssval_t: {SSCap(z,1)};

0:X0=z;
0:X3=y;
0:GCSPR_EL1=z;

1:X0=z;
1:X3=y;
1:GCSPR_EL1=&x[1];

}
 P0                                      | P1                                      ;
 GCSSS2 X0   (* GCS + GCSSB effect    *) | LDR W1,[X3]    (* Memory Read effect *) ;
 DMB SY                                  | DMB LD                                  ;
 MOV W2,#1                               | GCSSS1 X0      (* GCSSS1 effect      *) ;
 STR W2,[X3] (* Memory (Write) effect *) |                                         ;
                                         |                                         ;
exists ~fault(P0,GCS:SS2) /\ 1:X1=1
