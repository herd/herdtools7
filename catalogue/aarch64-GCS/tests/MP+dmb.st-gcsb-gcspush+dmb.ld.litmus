AArch64 MP+dmb.st-gcsb-gcspush+dmb.ld
variant=shadowstack
{
SS(x,1);

0:X2=y;
0:GCSPR_EL1=&x[1];

1:X2=x;
1:X4=y;
}

P0                                       | P1          ;
MOV W1,#1                                | LDR X1,[X2] ;
STR W1,[X2]  (* Memory (Write) Effect *) | DMB LD      ;
DMB ST                                   | LDR W3,[X4] ;
GCSB DSYNC   (* GCSB Effect           *) |             ;
MOV X0,#4                                |             ;
GCSPUSHM X0  (* GCS (Write) Effect    *) |             ;

exists 1:X1=4 /\ 1:X3=0
