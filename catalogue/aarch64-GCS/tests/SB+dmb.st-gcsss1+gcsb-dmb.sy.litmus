AArch64 SB+dmb.st-gcsss1+gcsb-dmb.sy
variant=shadowstack
{
SS(x,1);
SS(z,1);

0:X1=x;
0:X3=y;
0:GCSPR_EL1=z;

1:X1=x;
1:X3=y;

}
P0                                      | P1                                        ;
MOV W2,#1                               | ADD X2,X1,#1                              ;
STR W2,[X3] (* Memory (Write) effect *) | GCSSTR X2,[X1] (* GCS (Write) effect   *) ;
DMB ST                                  | GCSB DSYNC     (* GCSB effect          *) ;
GCSSS1 X1   (* GCSSS1 effect         *) | DMB SY                                    ;
                                        | LDR W0,[X3]    (* Memory (Read) effect *) ;

exists fault(P0,GCS:SS1) /\ 1:X0=0
