AArch64 MP+gcsss1-dmb.sy+dmb.ld
variant=shadowstack
{

SS(x,1) = ssval_t: {SSCap(x,1)};
SS(z,1);

0:X0=x;
0:X2=y;
0:GCSPR_EL1=&z[1];

1:X2=y;
1:X4=x;

}

P0                                       | P1          ;
GCSSS1 X0    (* GCSSS1 Memory Effect  *) | LDR W1,[X2] ;
DMB SY                                   | DMB LD      ;
MOV W1,#1                                | LDR X3,[X4] ;
STR W1,[X2]  (* Memory (Write) Effect *) |             ;

exists 1:X1=1 /\ 1:X3=SSCap(x,1) (* SSCap not supported in herd, yet *)


