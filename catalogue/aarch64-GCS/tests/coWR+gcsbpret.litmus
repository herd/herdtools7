AArch64 coWR+gcsbpret
variant=shadowstack, vmsa
{
  uint64_t y=1;

  SS(x,1);

  [PTE(y)]=(oa:PA(x)); (* Alias y to x, otherwise STR would fault *)

  0:GCSPR_EL1=&x[0];
  0:X0=y;
  0:LR=label:"P0:L0";
}
P0          ;
STR LR,[X0] ; (* Memory (Write) effect *)
GCSB DSYNC  ; (* GCSB effect           *)
RET         ; (* GCS (Read) effect     *)
L0:         ;

forall ~fault(P0,GCS:PRET)
