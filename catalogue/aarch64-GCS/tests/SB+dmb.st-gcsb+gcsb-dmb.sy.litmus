AArch64 SB+dmb.st-gcsb+gcsb-dmb.sy
variant=shadowstack
{
SS(x,1);

0:GCSPR_EL1=x;
0:X3=y;

1:X1=x;
1:X3=y;
}
P0                                      | P1                                        ;
MOV W1,#1                               | MOV X2,#4                                 ;
STR W1,[X3] (* Memory (Write) effect *) | GCSSTR X2,[X1] (* GCS (Write) effect   *) ;
DMB ST                                  | GCSB DSYNC     (* GCSB effect          *) ;
GCSB DSYNC  (* GCSB effect           *) | DMB SY                                    ;
GCSPOPM X0  (* GCS (Read) effect     *) | LDR W0,[X3]    (* Memory (Read) effect *) ;

exists (0:X0=0 /\ 1:X0=0)
