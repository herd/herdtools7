\chapter{Runtime Environment\label{chap:RuntimeEnvironment}}

An ASL runtime provides run time support within a hosting environment.

Examples of a hosting environment include an interactive interpreter,
an interpreter running in batch mode,
a Verilog simulator, and a Linux process (native executable).

\RequirementDef{EntryPoint}
The default entry point of a specification is the \vmain{} function, which has the signature
\verb|func main() => integer|.
An alternative (non-default) entry point may be specified by the user if
supported by the runtime. Not all runtimes may support alternative entry points.

When evaluation from the entry point returns (without
throwing an exception)
the runtime should pass the return value to the hosting environment.
%
An ASL runtime for native executables may use the return value
of the default entry point (\vmain{}) as the exit status of the process.
%
By convention a return value of zero indicates success and a return value of
one indicates failure.
%

See for example \listingref{main0}.

\ExampleDef{Returning a Value from the Entry Point}
In a \linuxbashshellterm{}, the return status of the specification \texttt{main0.asl},
shown in \listingref{main0},
when evaluated with the \aslrefterm{}
interpreter can be printed to the console as follows:
\begin{Verbatim}[frame=single]
> aslref main0.asl; echo "status="$?
> status=0
\end{Verbatim}

\ASLListing{A trivial specification returning \texttt{0}}{main0}{\definitiontests/main0.asl}

\RequirementDef{RuntimeUncaught}
Uncaught exceptions cause termination of the application by the runtime.
If an exception is thrown from the entry point, it is an uncaught exception.
The runtime should signal an error to the hosting environment.

\ExampleDef{An Uncaught Exception}
\listingref{main-uncaught} shows a specification throwing an exception
without catching it and the error status it returns --- \texttt{1} ---
when evaluated with the \aslrefterm{} in a \linuxbashshellterm{}:
\begin{verbatim}
> aslref main_uncaught.asl; echo "status="$?
> status=1
\end{verbatim}

\ASLListing{An uncaught exception}{main-uncaught}{\definitiontests/main_uncaught.asl}

\RequirementDef{Printing}
Output may be printed by using the \printstatementterm{} on
runtimes that support printing.
%
\listingref{semantics-literals} shows an example of a specification
with printing and the output generated by evaluating it with \aslrefterm{}
in a \linuxbashshellterm{}.
