%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Macros for defining and for rendering generated LaTeX elements

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% \DefineConstant{name}{content} - Define a macro for later rendering constants
%% \RenderConstant{name} - Render the defined constant
\makeatletter
\newcommand{\DefineConstant}[2]{%
  \expandafter\newcommand\csname RenderConstant@#1\endcsname{#2}%
}

% Main RenderConstant command with optional parameter
\newcommand{\RenderConstant}[2][]{%
  \@ifundefined{RenderConstant@#2}{%
    \PackageError{rendering_macros}{RenderConstant '#2' is not defined! Check that you have defined constant '#2' and applied aslspec to generate \string\DefineConstant}{}%
  }{%
    \expandafter\let\expandafter\@current@content\csname RenderConstant@#2\endcsname%
    \def\@renderconstant@option{#1}%
    \def\@test@remove{remove_hypertargets}%
    \ifx\@renderconstant@option\@test@remove%
      \expandafter\remove@hypertargets\expandafter{\@current@content}%
    \else%
      \@current@content%
    \fi%
  }%
}
\makeatother

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% \DefineType{name}{content} - Define a type macro for later rendering
%% \RenderType{name}[options] - Render a single type
%%   Usage:
%%     \RenderType{typename}                    - Render single type
%%     \RenderType[remove_hypertargets]{type1}  - Remove \hypertarget{...}{} commands from output   % DO NOT LINT
%%
%%   The optional [remove_hypertargets] parameter strips all \hypertarget{...}{}                    % DO NOT LINT
%%   commands from the rendered content, useful for generating clean text versions.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\makeatletter
\newcommand{\DefineType}[2]{%
  \expandafter\newcommand\csname RenderType@#1\endcsname{#2}%
}

% Helper to remove hypertargets from content
\long\def\remove@hypertargets#1{%
  \begingroup%
  \def\hypertarget##1##2{}% Redefine \hypertarget to do nothing
  #1% Execute the content with \hypertarget disabled
  \endgroup%
}

% Main RenderType command with optional parameter
\newcommand{\RenderType}[2][]{%
  \@ifundefined{RenderType@#2}{%
    \PackageError{rendering_macros}{RenderType '#2' is not defined! Check that you have defined type '#2' and applied aslspec to generate \string\DefineType}{}%
  }{%
    \expandafter\let\expandafter\@current@content\csname RenderType@#2\endcsname%
    \def\@rendertype@option{#1}%
    \def\@test@remove{remove_hypertargets}%
    \ifx\@rendertype@option\@test@remove%
      \expandafter\remove@hypertargets\expandafter{\@current@content}%
    \else%
      \@current@content%
    \fi%
  }%
}
\makeatother

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% \DefineRelation{name}{content} - Define a macro for later rendering relations
%% \RenderRelation{name} - Render the defined relation
\makeatletter
\newcommand{\DefineRelation}[2]{%
  \expandafter\newcommand\csname RenderRelation@#1\endcsname{#2}%
}
\newcommand{\RenderRelation}[1]{%
  \@ifundefined{RenderRelation@#1}{%
    \PackageError{rendering_macros}{RenderRelation '#1' is not defined! Check that you have defined relation '#1' and applied aslspec to generate \string\DefineRelation}{}%
  }{%
    \csname RenderRelation@#1\endcsname%
  }%
}
\makeatother

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% \DefineRenderTypes{name}{content} - Define a macro for later rendering
%% a list of subsets of complex types.
%% \RenderTypes{name}[options] - Render the list of subsets of complex types.
%%   Usage:
%%     \RenderTypes{typename}                    - Render list of types
%%     \RenderTypes[remove_hypertargets]{type1}  - Remove \hypertarget{...}{} commands from output    % DO NOT LINT
%%
%%   The optional [remove_hypertargets] parameter strips all \hypertarget{...}{}                      % DO NOT LINT
%%   commands from the rendered content, useful for generating clean text versions.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\makeatletter
\newcommand{\DefineRenderTypes}[2]{%
  \expandafter\newcommand\csname RenderTypes@#1\endcsname{#2}%
}

% Main RenderTypes command with optional parameter
\newcommand{\RenderTypes}[2][]{%
  \@ifundefined{RenderTypes@#2}{%
    \PackageError{rendering_macros}{RenderTypes '#2' is not defined! Check that you have defined render '#2' and applied aslspec to generate \string\DefineRenderTypes}{}%
  }{%
    \expandafter\let\expandafter\@current@content\csname RenderTypes@#2\endcsname%
    \def\@rendertypes@option{#1}%
    \def\@test@remove{remove_hypertargets}%
    \ifx\@rendertypes@option\@test@remove%
      \expandafter\remove@hypertargets\expandafter{\@current@content}%
    \else%
      \@current@content%
    \fi%
  }%
}
\makeatother

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% \DefineRule{name}{content} - Define a macro for later rendering rules
%% \RenderRule{name} - Render the defined rule
\makeatletter
\newcommand{\DefineRule}[2]{%
  \expandafter\newcommand\csname RenderRule@#1\endcsname{#2}%
}
\newcommand{\RenderRule}[1]{%
  \@ifundefined{RenderRule@#1}{%
    \textbf{Error: RenderRule '#1' not defined}%
  }{%
    \csname RenderRule@#1\endcsname%
  }%
}
\makeatother
